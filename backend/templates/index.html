<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quantum Certificate Verification System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===================== RESET ===================== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* ===================== BODY ===================== */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea, #764ba2);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

/* ===================== CONTAINER ===================== */
.container {
  width: 100%;
  max-width: 900px;
  background: #ffffff;
  border-radius: 18px;
  box-shadow: 0 25px 60px rgba(0,0,0,0.3);
  overflow: hidden;
}

/* ===================== HEADER ===================== */
header {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: #fff;
  padding: 35px 20px;
  text-align: center;
}

header h1 {
  font-size: 2.3rem;
  margin-bottom: 8px;
}

header p {
  font-size: 1.05rem;
  opacity: 0.9;
}

/* ===================== TABS ===================== */
.tabs {
  display: flex;
  background: #f1f3f6;
}

.tab-btn {
  flex: 1;
  padding: 16px;
  border: none;
  background: transparent;
  cursor: pointer;
  font-weight: 600;
  font-size: 1rem;
  color: #555;
  transition: 0.3s;
}

.tab-btn:hover {
  background: #e4e7eb;
}

.tab-btn.active {
  background: #ffffff;
  color: #667eea;
  border-bottom: 3px solid #667eea;
}

/* ===================== CONTENT ===================== */
.tab-content {
  display: none;
  padding: 35px;
}

.tab-content.active {
  display: block;
}

h2 {
  margin-bottom: 25px;
  color: #333;
  text-align: center;
}

/* ===================== FORM ===================== */
form {
  max-width: 500px;
  margin: auto;
}

.form-group {
  margin-bottom: 18px;
}

.form-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  color: #444;
}

.form-group input {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: 2px solid #ddd;
  font-size: 0.95rem;
}

.form-group input:focus {
  outline: none;
  border-color: #667eea;
}

/* ===================== BUTTONS ===================== */
.btn {
  width: 100%;
  padding: 14px;
  border-radius: 8px;
  border: none;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: 0.3s;
  margin-top: 10px;
}

.btn-primary {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: #fff;
}

.btn-secondary {
  background: linear-gradient(135deg, #f093fb, #f5576c);
  color: #fff;
}

.btn-info {
  background: linear-gradient(135deg, #4facfe, #00f2fe);
  color: #fff;
  width: auto;
  padding: 12px 25px;
  display: block;
  margin: 0 auto 25px auto;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(0,0,0,0.2);
}

/* ===================== RESULT BOX ===================== */
.result {
  margin-top: 25px;
  padding: 18px;
  border-radius: 10px;
  display: none;
  white-space: pre-wrap;
  font-size: 0.95rem;
}

.result.success {
  display: block;
  background: #d4edda;
  border: 2px solid #28a745;
  color: #155724;
}

.result.error {
  display: block;
  background: #f8d7da;
  border: 2px solid #dc3545;
  color: #721c24;
}

/* ===================== CERTIFICATE CARDS ===================== */
.certificate-card {
  background: #f8f9fa;
  padding: 18px;
  margin-bottom: 15px;
  border-radius: 10px;
  border-left: 4px solid #667eea;
  font-size: 0.95rem;
}

/* ===================== RESPONSIVE ===================== */
@media (max-width: 600px) {
  header h1 {
    font-size: 1.7rem;
  }
  .tab-content {
    padding: 25px 20px;
  }
}
</style>
</head>

<body>

<div class="container">

<header>
  <h1>Quantum Certificate Verification</h1>
  <p>Quantum-Resistant Fake Certificate Detection System</p>
</header>

<div class="tabs">
  <button class="tab-btn active" onclick="showTab('issue')">Issue</button>
  <button class="tab-btn" onclick="showTab('verify')">Verify</button>
  <button class="tab-btn" onclick="showTab('view')">View</button>
</div>

<!-- ISSUE -->
<div id="issue-tab" class="tab-content active">
  <h2>Issue Certificate</h2>
  <form id="issue-form">
    <div class="form-group">
      <label>Certificate ID</label>
      <input id="issue-id" required>
    </div>
    <div class="form-group">
      <label>Holder Name</label>
      <input id="issue-name" required>
    </div>
    <div class="form-group">
      <label>Course</label>
      <input id="issue-course" required>
    </div>
    <div class="form-group">
      <label>Issue Date</label>
      <input type="date" id="issue-date" required>
    </div>
    <button class="btn btn-primary">Issue Certificate</button>
  </form>
  <div id="issue-result" class="result"></div>
</div>

<!-- VERIFY -->
<div id="verify-tab" class="tab-content">
  <h2>Verify Certificate</h2>
  <form id="verify-form">
    <div class="form-group">
      <label>Certificate ID</label>
      <input id="verify-id" required>
    </div>
    <div class="form-group">
      <label>Holder Name</label>
      <input id="verify-name" required>
    </div>
    <div class="form-group">
      <label>Course</label>
      <input id="verify-course" required>
    </div>
    <div class="form-group">
      <label>Issue Date</label>
      <input type="date" id="verify-date" required>
    </div>
    <button class="btn btn-secondary">Verify Certificate</button>
  </form>
  <div id="verify-result" class="result"></div>
</div>

<!-- VIEW -->
<div id="view-tab" class="tab-content">
  <h2>Issued Certificates</h2>
  <button class="btn btn-info" onclick="loadAllCertificates()">Refresh</button>
  <div id="certificates-list"></div>
</div>

</div>

<script>
const API_URL = "http://localhost:5000/api/certificates";

/* ================= TAB SWITCH ================= */
function showTab(tab) {
  // Hide all tabs
  document.querySelectorAll(".tab-content").forEach(t => t.classList.remove("active"));
  document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));

  // Show selected tab
  document.getElementById(`${tab}-tab`).classList.add("active");
  event.target.classList.add("active");

  // Auto-load certificates when View tab opens
  if (tab === "view") {
    loadAllCertificates();
  }
}

/* ================= ISSUE CERTIFICATE ================= */
document.getElementById("issue-form").addEventListener("submit", function (e) {
  e.preventDefault();

  const payload = {
    certificateId: document.getElementById("issue-id").value,
    holderName: document.getElementById("issue-name").value,
    course: document.getElementById("issue-course").value,
    issueDate: document.getElementById("issue-date").value
  };

  fetch(`${API_URL}/issue`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
    .then(res => res.json())
    .then(data => {
      const box = document.getElementById("issue-result");
      box.className = "output-card " + (data.success ? "output-success" : "output-error");

      if (data.success) {
        box.innerHTML = `
          <div class="output-title">‚úÖ Certificate Issued Successfully</div>
          <div><b>Certificate ID:</b> ${data.certificate.certificateId}</div>
          <div><b>Holder Name:</b> ${data.certificate.holderName}</div>
          <div><b>Course:</b> ${data.certificate.course}</div>
          <div><b>Issue Date:</b> ${data.certificate.issueDate}</div>
          <div class="output-hash"><b>Quantum Hash:</b><br>${data.certificate.quantumHash}</div>
          <span class="badge badge-valid">VALID</span>
        `;
      } else {
        box.innerHTML = `<div class="output-title">‚ùå ${data.message}</div>`;
      }
    })
    .catch(err => {
      alert("Issue Error: " + err.message);
    });
});

/* ================= VERIFY CERTIFICATE ================= */
document.getElementById("verify-form").addEventListener("submit", function (e) {
  e.preventDefault();

  const payload = {
    certificateId: document.getElementById("verify-id").value,
    holderName: document.getElementById("verify-name").value,
    course: document.getElementById("verify-course").value,
    issueDate: document.getElementById("verify-date").value
  };

  fetch(`${API_URL}/verify`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
    .then(res => res.json())
    .then(data => {
      const box = document.getElementById("verify-result");

      if (data.isValid) {
        box.className = "output-card output-success";
        box.innerHTML = `
          <div class="output-title">‚úÖ Authentic Certificate</div>
          <div><b>Certificate ID:</b> ${data.originalData.certificateId}</div>
          <div><b>Holder Name:</b> ${data.originalData.holderName}</div>
          <div><b>Course:</b> ${data.originalData.course}</div>
          <span class="badge badge-valid">GENUINE</span>
        `;
      } else {
        box.className = "output-card output-error";
        box.innerHTML = `
          <div class="output-title">‚ö†Ô∏è Fake Certificate Detected</div>
          <p>Certificate data does not match our records.</p>
          <span class="badge badge-fake">FAKE</span>
        `;
      }
    })
    .catch(err => {
      alert("Verify Error: " + err.message);
    });
});

/* ================= LOAD ALL CERTIFICATES ================= */
function loadAllCertificates() {
  const list = document.getElementById("certificates-list");

  list.innerHTML = `<p style="text-align:center;">‚è≥ Loading certificates...</p>`;

  fetch(`${API_URL}/all`)
    .then(res => res.json())
    .then(data => {

      if (!data.certificates || data.certificates.length === 0) {
        list.innerHTML = `<p style="text-align:center;">üìÑ No certificates issued yet</p>`;
        return;
      }

      list.innerHTML = "";

      data.certificates.forEach(cert => {
        const card = document.createElement("div");
        card.className = "certificate-card";
        card.innerHTML = `
          <b>Certificate ID:</b> ${cert.certificateId}<br>
          <b>Holder Name:</b> ${cert.holderName}<br>
          <b>Course:</b> ${cert.course}<br>
          <b>Issue Date:</b> ${cert.issueDate}<br>
          <b>Status:</b> ${cert.status.toUpperCase()}
        `;
        list.appendChild(card);
      });
    })
    .catch(err => {
      list.innerHTML = `<p style="color:red;">‚ùå Failed to load certificates</p>`;
    });
}

/* ================= DEFAULT DATE ================= */
document.getElementById("issue-date").value =
document.getElementById("verify-date").value =
  new Date().toISOString().split("T")[0];
</script>


</body>
</html>
